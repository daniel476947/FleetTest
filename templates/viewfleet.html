<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fleet Management - View Fleet</title>

  <!-- Bootstrap 5 CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" 
    rel="stylesheet"
  >

  <!-- Bootstrap Icons CSS -->
  <link 
    rel="stylesheet" 
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
  />

  <!-- Combined CSS Styles -->
  <style>
    /* ============ NAVBAR & BODY PADDING ============ */
    .navbar {
      background-color: black;
      padding-top: 15px;
      padding-bottom: 15px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
    }

    .navbar-nav .nav-link {
      color: white !important;
    }

    .navbar-nav .nav-link:hover {
      color: #777684 !important;
    }

    .navbar-container {
      padding-left: 30px;
      padding-right: 30px;
    }

    /* Add padding to the body to prevent content from being hidden behind the navbar */
    body {
      padding-top: 75px; /* Adjust this based on your navbar height */
    }

    /* ============ TABLE STYLING ============ */
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
      font-weight: bold;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    .table-container {
      margin-top: 50px;
      overflow-x: auto;
    }

    /* ============ FOOTER STYLES ============ */
    .footer {
      background-color: black;
      color: white;
      padding: 20px 0;
      text-align: center;
      position: relative;
      bottom: 0;
      width: 100%;
      margin-top: 100px; /* Add margin on top */
    }

    .footer a {
      color: #f8f9fa;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    .footer p {
      margin: 0;
    }

    /* ============ STICKY COLUMN STYLING ============ */

    /* Existing sticky column styles */
    .sticky-column {
        position: sticky;
        left: 0;
        background-color: #fff; /* Fully opaque background */
        z-index: 10; /* Ensure it stays above other cells */
        white-space: nowrap; /* Prevent text wrapping */
        border-right: 1px solid #ddd; /* Right border for separation */
        box-shadow: 2px 0 5px -2px rgba(0, 0, 0, 0.1); /* Optional shadow */
    }

    /* Header cell styling */
    thead th.sticky-column {
        background-color: #f4f4f4; /* Match your header background */
        z-index: 11; /* Higher than body cells */
        border-right: 1px solid #ddd; /* Right border for consistency */
    }

    /* Alternating background colors for body cells in the sticky column */
    tbody tr:nth-child(odd) td.sticky-column {
        background-color: #ffffff; /* White for odd rows */
    }

    tbody tr:nth-child(even) td.sticky-column {
        background-color: #f9f9f9; /* Light grey for even rows */
    }

    .navbar .navbar-toggler-icon {
  background-image: url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 30 30' 
  xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='white' 
  stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' 
  d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E") !important;
}
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid navbar-container"> 
      <!-- Logo on the left -->
      <a class="navbar-brand" href="#">
        <img src="/static/logo.jpeg" alt="Company Logo" style="height: 40px;">
      </a>

      <!-- Toggle button for mobile view -->
      <button 
        class="navbar-toggler" 
        type="button" 
        data-bs-toggle="collapse" 
        data-bs-target="#navbarNav" 
        aria-controls="navbarNav" 
        aria-expanded="false" 
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar links -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Fleet</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/form">Form</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- PAGE TITLE & CONTAINER -->
  <div class="container mt-5">
    <h1 class="text-center mb-4">Fleet Management - View Fleet</h1>
    
    <!-- Search Form -->
    <div class="mb-4">
      <form method="POST">
        <div class="row g-3">
          <!-- Search Bar -->
          <div class="col-12 col-md-6">
            <input 
              type="text" 
              name="search" 
              class="form-control" 
              placeholder="Search by Registration No, Make, Model or Chassis No"
            >
          </div>

          <!-- Registration Status Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="registration_status" class="form-select">
              <option value="">Registration Status</option>
              <option value="Registered">Registered</option>
              <option value="Unregistered">Unregistered</option>
            </select>
          </div>

          <!-- Vehicle Type Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="vehicle_type" class="form-select">
              <option value="">Vehicle Type</option>
              <option value="Sedan">Sedan</option>
              <option value="Hatchback">Hatchback</option>
              <option value="SUV">SUV</option>
              <option value="Mini Van">Mini Van</option>
              <option value="Van">Van</option>
              <option value="Truck">Truck</option>
              <option value="Wagon">Wagon</option>
              <option value="Coupe">Coupe</option>
              <option value="Mini Bus">Mini Bus</option>
              <option value="Medium Bus">Medium Bus</option>
              <option value="Large Bus">Large Bus</option>
              <option value="Pick up">Pick up</option>
              <option value="Convertible">Convertible</option>
              <option value="Tractor">Tractor</option>
              <option value="Forklift">Forklift</option>
              <option value="Machinery">Machinery</option>
            </select>
          </div>

          <!-- Main Colour Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="main_colour" class="form-select">
              <option value="">Main Colour</option>
              <option value="Beige">Beige</option>
              <option value="Black">Black</option>
              <option value="Blue">Blue</option>
              <option value="Brown">Brown</option>
              <option value="Burgundy">Burgundy</option>
              <option value="Gold">Gold</option>
              <option value="Gray">Gray</option>
              <option value="Green">Green</option>
              <option value="Orange">Orange</option>
              <option value="Pink">Pink</option>
              <option value="Purple">Purple</option>
              <option value="Red">Red</option>
              <option value="Silver">Silver</option>
              <option value="Teal">Teal</option>
              <option value="Turquoise">Turquoise</option>
              <option value="White">White</option>
              <option value="Wine Red">Wine Red</option>
              <option value="Yellow">Yellow</option>
            </select>
          </div>

          <!-- Secondary Colour Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="secondary_colour" class="form-select">
              <option value="">Secondary Colour</option>
              <option value="Beige">Beige</option>
              <option value="Black">Black</option>
              <option value="Blue">Blue</option>
              <option value="Brown">Brown</option>
              <option value="Burgundy">Burgundy</option>
              <option value="Gold">Gold</option>
              <option value="Gray">Gray</option>
              <option value="Green">Green</option>
              <option value="Orange">Orange</option>
              <option value="Pink">Pink</option>
              <option value="Purple">Purple</option>
              <option value="Red">Red</option>
              <option value="Silver">Silver</option>
              <option value="Teal">Teal</option>
              <option value="Turquoise">Turquoise</option>
              <option value="White">White</option>
              <option value="Wine Red">Wine Red</option>
              <option value="Yellow">Yellow</option>
            </select>
          </div>

          <!-- Fuel Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="fuel" class="form-select">
              <option value="">Fuel</option>
              <option value="Gas">Gas</option>
              <option value="Diesel">Diesel</option>
            </select>
          </div>

          <!-- Status Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="status" class="form-select">
              <option value="">Status</option>
              <option value="Active">Active</option>
              <option value="Parked">Parked</option>
              <option value="Out of Order">Out of Order</option>
            </select>
          </div>

          <!-- Location Dropdown -->
          <div class="col-6 col-md-3 col-lg-2">
            <select name="location" class="form-select">
              <option value="">Location</option>
              <option value="Prashad Nagar">Prashad Nagar</option>
              <option value="Eccles">Eccles</option>
            </select>
          </div>

          <!-- Apply Button -->
          <div class="col-12 text-center">
            <button type="submit" class="btn btn-primary">Search</button>
          </div>
        </div>
      </form>
    </div>
    
    <div class="text-end mb-2">
      <strong>{{ vehicles|length }} records found</strong>
    </div>

    <!-- Vehicle Table -->
    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th class="sticky-column">No.</th>
            <th>Registration No</th>
            <th>Make</th>
            <th>Model</th>
            <th>Vehicle Type</th>
            <th>Year</th>
            <th>Main Colour</th>
            <th>Secondary Colour</th>
            <th>Fuel</th>
            <th>Capacity</th>
            <th>Chassis No</th>
            <th>Model No</th>
            <th>Status</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for vehicle in vehicles %}
            <tr>
              <td class="sticky-column">{{ loop.index }}</td>
              <td>{{ vehicle['Registration No'] }}</td>
              <td>{{ vehicle['Make'] }}</td>
              <td>{{ vehicle['Model'] }}</td>
              <td>{{ vehicle['Vehicle Type'] }}</td>
              <td>{{ vehicle['Year'] }}</td>
              <td>{{ vehicle['Main Colour'] }}</td>
              <td>{{ vehicle['Secondary Colour'] }}</td>
              <td>{{ vehicle['Fuel'] }}</td>
              <td>{{ vehicle['Capacity'] }}</td>
              <td>{{ vehicle['Chassis No'] }}</td>
              <td>{{ vehicle['Model No'] }}</td>
              <td>{{ vehicle['Status'] }}</td>
              <td>{{ vehicle['Location'] }}</td>
              <td>
                <div class="btn-group" role="group" aria-label="Actions">
                  <!-- Edit Button -->
                  <a href="/edit/{{ vehicle['_id'] }}" class="btn btn-sm btn-primary w-100 me-2">
                    <i class="bi bi-pencil-square"></i> Edit
                  </a>
                  <!-- Delete Button -->
                  <form 
                    action="/delete/{{ vehicle['_id'] }}" 
                    method="POST" 
                    style="display:inline;"
                  >
                    <button 
                      type="submit" 
                      class="btn btn-sm btn-danger"
                      onclick="return confirm('Are you sure you want to delete this vehicle?');"
                    >
                      <i class="bi bi-trash"></i> Delete
                    </button>
                  </form>
                </div>
              </td>
            </tr>  
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="text-center mt-4">
      <a 
        href="{{ url_for('export_fleet', 
                search=request.form.get('search', ''), 
                vehicle_type=request.form.get('vehicle_type', ''),
                main_colour=request.form.get('main_colour', ''), 
                secondary_colour=request.form.get('secondary_colour', ''),
                fuel=request.form.get('fuel', ''), 
                status=request.form.get('status', ''), 
                location=request.form.get('location', ''),
                registration_status=request.form.get('registration_status', '')  
            ) }}"
        class="btn btn-success"
      >
        <i class="bi bi-file-earmark-excel"></i> Export Data to Excel
      </a>
    </div>
  </div>
    
  <!-- FOOTER -->
  <footer class="footer">
    <p>&copy; 2025 Knight Rider Transportation. All rights reserved.</p>
    <p>
      <a href="/privacy-policy">Privacy Policy</a> | 
      <a href="/terms-of-service">Terms of Service</a>
    </p>
  </footer> 

  <!-- Bootstrap 5 JS (Optional for advanced components) -->
  <script 
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
  ></script>
</body>
</html>
